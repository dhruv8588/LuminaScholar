{% load custom_filters %}        

{% if duplicate_files %}
    <div class="error-box"> 
        <i class="fas fa-exclamation-triangle"></i>&nbsp;Please attend to the following:<br/>
        <ul>
            {% for file in duplicate_files %}
                <li>A file named {{ file }} is already uploaded for this manuscript. If you want to upload this file (e.g. this is a replacement for an existing file) you must rename the new file and then upload it</li>
            {% endfor %}
        </ul> 
    </div>
{% endif %}

<li class="file list-group-item d-flex justify-content-between align-items-center">    
    <span><b>ORDER FILE DESIGNATION UPLOAD-DATE ACTION</b></span>
</li>
{% csrf_token %}
<form class="sortable list-group" hx-trigger="end" hx-post="{% url 'sort_files' paper.id %}" hx-target="#files">
    <div class="htmx-indicator">Updating...</div>
    {% for file in paper.files.all %}
        <div>
            <input type="hidden" name="file_order" value="{{ file.pk }}"/>
            <li class="file list-group-item d-flex justify-content-between align-items-center">    
                {% if file.file.name|is_image %}
                    #{{ file.order }}
                    <img src="{{ file.file.url }}" alt="{{ file|basename }}" style="max-width: 100px; max-height:100px;"/> 
                    <a href="{{ file.file.url }}">{{ file|basename }}</a>
                {% else %}
                    <span>#{{ file.order }} <a href="{{ file.file.url }}">{{ file|basename }}</a></span>
                {% endif %}

                {{ file.designation }}

                {{ file.created_at|date }}

                <span class="badge badge-danger badge-pill" 
                        style="cursor: pointer;"
                        hx-delete="{% url 'delete_file' paper.id file.pk %}"
                        hx-target="#files"
                        hx-confirm="Are you sure you wish to delete this file?">X</span>
            </li>
        </div>    
    {% endfor %}
</form>    






